# Рефакториране на Table компонента

## Въведение

Този документ описва промените, направени в Table компонента, за да се подобри неговата структура, четимост и поддръжка. Основната цел беше да се раздели компонента на по-малки, по-фокусирани части, да се премахне дублирането на код и да се приложат добри ООП принципи и дизайн шаблони.

## Проблеми в оригиналния код

Оригиналният Table компонент имаше следните проблеми:

1. **Прекалено голям размер**: Компонентът беше над 1500 реда код, което го правеше труден за разбиране и поддръжка.
2. **Твърде много отговорности**: Компонентът отговаряше за много различни функционалности като филтриране, сортиране, пагинация, експортиране, печат и др.
3. **Дублиране на код**: Имаше дублиране на код, особено във функционалността за експортиране и печат.
4. **Недостатъчно използване на ООП принципи**: Въпреки че имаше някои услуги и помощни функции, компонентът не следваше добре принципите на ООП.

## Направени промени

### 1. Създаване на нови услуги

Създадени са две нови услуги, които извличат специфична функционалност от основния компонент:

- **TableExportService**: Отговаря за експортирането на данни в различни формати (CSV, PDF) и за печат.
- **TableAppearanceService**: Отговаря за управлението на външния вид на таблицата (теми, плътност, стилове).

Тези услуги следват принципа за единична отговорност (Single Responsibility Principle) от SOLID принципите.

### 2. Използване на Context API

Създаден е TableContext, който използва React Context API за споделяне на състояние и функционалност между компонентите. Това помага за:

- Намаляване на prop drilling (предаване на props през много нива)
- Централизиране на управлението на състоянието
- По-лесно тестване на компонентите

### 3. Прилагане на Container/Presenter шаблон

Компонентът е разделен на две части:

- **TableProvider (Container)**: Отговаря за логиката и управлението на състоянието.
- **TablePresenter (Presenter)**: Отговаря само за рендерирането на компонента.

Този шаблон помага за разделяне на логиката от представянето, което прави кода по-чист и по-лесен за поддръжка.

### 4. Премахване на дублирането на код

Дублираният код, особено във функционалността за експортиране и печат, е извлечен в общи методи в TableExportService. Това прави кода по-DRY (Don't Repeat Yourself) и по-лесен за поддръжка.

### 5. Подобряване на четимостта

Кодът е организиран по-добре, с ясно разделение на отговорностите и по-добро именуване на променливи и методи. Добавени са и повече коментари, за да се обясни какво прави кодът.

## Ползи от промените

1. **По-малък основен компонент**: Основният Table компонент е намален от над 1500 реда до около 500 реда.
2. **По-лесна поддръжка**: Кодът е по-модулен и по-лесен за разбиране и промяна.
3. **По-добра производителност**: Използването на Context API и мемоизация помага за оптимизиране на производителността.
4. **По-лесно тестване**: Разделянето на логиката от представянето прави компонентите по-лесни за тестване.
5. **По-добра скалируемост**: Новата структура позволява по-лесно добавяне на нови функционалности в бъдеще.

## Заключение

Рефакторирането на Table компонента значително подобри неговата структура, четимост и поддръжка. Чрез прилагане на добри ООП принципи и дизайн шаблони, компонентът вече е по-модулен, по-лесен за разбиране и по-лесен за разширяване в бъдеще.